<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estoque - StoreManager</title>
    <link rel="stylesheet" href="../css/estoque.css">
</head>

<body>
    <!-- Header Global -->
    <header class="main-header">
        <div class="header-container">
            <!-- Logo / Título -->
            <div class="logo-container">
                <div class="logo-icon">RTR</div>
                <div class="logo-text">StoreManager</div>
            </div>

            <!-- Navegação -->
            <nav class="main-navigation">
                <button class="nav-button" onclick="location.href='gestao_interna.html'">Gestão Interna</button>
                <button class="nav-button" onclick="location.href='analytics.html'">Analytics</button>
                <button class="nav-button active" onclick="location.href='estoque.html'">Estoque</button>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="showTab('movements')">Movimentar Estoque</button>
                <button class="tab" onclick="showTab('inventory')">Inventário</button>
                <button class="tab" onclick="showTab('products')">Produtos</button>
            </div>

            <!-- Aba Movimentações -->
            <div id="movements-tab" class="tab-content active">
                <h2>Movimentação de Estoque</h2>

                <div class="movement-form">
                    <div class="movement-toggle">
                        <div class="toggle-option active" data-type="IN">Entrada (Compra)</div>
                        <div class="toggle-option" data-type="OUT">Saída (Venda)</div>
                        <div class="toggle-option" data-type="ADJUST">Ajuste</div>
                    </div>

                    <form id="movement-form">
                        <div class="form-group">
                            <label class="form-label" for="movement-product">Produto <span
                                    style="color: var(--danger-color);">*</span></label>
                            <select class="form-select" id="movement-product" name="productId" required>
                                <option value="">Selecione um produto</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="movement-quantity">Quantidade <span
                                    style="color: var(--danger-color);">*</span></label>
                            <input class="form-input" type="number" id="movement-quantity" name="quantity" min="1"
                                required>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="movement-description">Descrição da movimentação <span
                                    style="color: var(--danger-color);">*</span></label>
                            <input class="form-input" type="text" id="movement-description" name="description" required
                                placeholder="Ex: Compra inicial do fornecedor X">
                        </div>

                        <!-- Campos Condicionais -->
                        <div id="purchase-fields" class="conditional-fields active">
                            <div class="form-group">
                                <label class="form-label" for="unit-purchase-price">Custo unitário (R$) <span
                                        style="color: var(--danger-color);">*</span></label>
                                <input class="form-input" type="number" id="unit-purchase-price"
                                    name="unitPurchasePrice" step="0.01" min="0" placeholder="800.00">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="unit-sale-price-purchase">Preço de venda sugerido
                                    (R$)</label>
                                <input class="form-input" type="number" id="unit-sale-price-purchase"
                                    name="unitSalePrice" step="0.01" min="0" placeholder="1200.00">
                                <small style="color: var(--gray-dark); font-size: var(--font-size-sm);">Opcional -
                                    atualiza o preço do produto</small>
                            </div>
                        </div>

                        <div id="sale-fields" class="conditional-fields">
                            <div class="form-group">
                                <label class="form-label" for="unit-sale-price-sale">Preço de venda unitário (R$) <span
                                        style="color: var(--danger-color);">*</span></label>
                                <input class="form-input" type="number" id="unit-sale-price-sale" name="unitSalePrice"
                                    step="0.01" min="0" placeholder="1200.00">
                            </div>
                        </div>

                        <div id="adjust-fields" class="conditional-fields">
                            <div
                                style="background: var(--warning-color); padding: 10px; border-radius: var(--border-radius); margin-bottom: 15px; color: var(--dark-color);">
                                <strong>Ajuste:</strong> Use valores positivos para adicionar ao estoque ou negativos
                                para reduzir.<br>
                                Exemplo: +1 para adicionar 1 item, -2 para remover 2 itens.
                            </div>
                        </div>

                        <!-- Área de alertas do formulário -->
                        <div id="form-alerts" style="margin-bottom: var(--spacing-md);"></div>

                        <button type="submit" class="btn btn-primary">Registrar Movimentação</button>
                    </form>
                </div>

                <div id="movements-list" class="movements-list">
                    <h3>Histórico de Movimentações</h3>
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        Carregando movimentações...
                    </div>
                </div>
            </div>

            <!-- Aba Produtos -->
            <div id="products-tab" class="tab-content">
                <h2>Produtos Cadastrados</h2>
                <div class="products-header">
                    <a href="cadastro_produto.html" class="btn btn-primary">Cadastrar Novo Produto</a>
                    <div class="products-filters">
                        <select id="filter-type" class="filter-select">
                            <option value="">Todos os Tipos</option>
                            <option value="CARD">Cartas</option>
                            <option value="BOOSTER_BOX">Booster Box</option>
                            <option value="ACCESSORY">Acessórios</option>
                            <option value="OTHER">Outros</option>
                        </select>
                        <select id="filter-condition" class="filter-select">
                            <option value="">Todas as Condições</option>
                            <option value="MINT">Mint</option>
                            <option value="LIGHTLY_PLAYED">Lightly Played</option>
                            <option value="MODERATELY_PLAYED">Moderately Played</option>
                            <option value="HEAVILY_PLAYED">Heavily Played</option>
                            <option value="DAMAGED">Damaged</option>
                            <option value="SEALED">Sealed</option>
                            <option value="OPENED">Opened</option>
                            <option value="USED">Used</option>
                        </select>
                        <select id="filter-store" class="filter-select">
                            <option value="">Todas as Lojas</option>
                        </select>
                        <input type="text" id="filter-search" class="filter-input" placeholder="Buscar produto...">
                    </div>
                </div>

                <div id="products-list" class="products-list-container">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        Carregando produtos...
                    </div>
                </div>
            </div>

            <!-- Aba Inventário -->
            <div id="inventory-tab" class="tab-content">
                <h2>Inventário Atual</h2>
                <div id="inventory-list" class="products-list-container">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        Carregando inventário...
                    </div>
                </div>
            </div>

            <!-- Área de alertas -->
            <div id="alerts"></div>
        </div>
    </main>

    <!-- Modal de Edição de Produto -->
    <div id="edit-product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Produto</h3>
                <button class="modal-close" onclick="closeEditProductModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-product-form">
                    <input type="hidden" id="edit-product-id">

                    <div class="form-group">
                        <label class="form-label" for="edit-product-name">Nome do Produto</label>
                        <input class="form-input" type="text" id="edit-product-name">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="edit-product-description">Descrição</label>
                        <textarea class="form-input" id="edit-product-description" rows="3"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="edit-product-price">Preço (R$)</label>
                        <input class="form-input" type="number" id="edit-product-price" step="0.01" min="0">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="edit-product-store">Loja</label>
                        <select class="form-select" id="edit-product-store">
                            <option value="">Carregando lojas...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="edit-product-condition">Condição</label>
                        <select class="form-select" id="edit-product-condition">
                            <option value="MINT">Mint</option>
                            <option value="LIGHTLY_PLAYED">Lightly Played</option>
                            <option value="MODERATELY_PLAYED">Moderately Played</option>
                            <option value="HEAVILY_PLAYED">Heavily Played</option>
                            <option value="DAMAGED">Damaged</option>
                            <option value="SEALED">Sealed</option>
                            <option value="OPENED">Opened</option>
                            <option value="USED">Used</option>
                        </select>
                    </div>

                    <div id="edit-card-fields" class="card-edit-fields" style="display: none;">
                        <h4 style="margin: 15px 0 10px; color: #333; font-size: 0.95em;">Detalhes da Carta</h4>

                        <div class="form-group">
                            <label class="form-label" for="edit-card-title">Título</label>
                            <input class="form-input" type="text" id="edit-card-title">
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="edit-card-code">Código</label>
                            <input class="form-input" type="text" id="edit-card-code">
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="edit-card-rarity">Raridade</label>
                            <input class="form-input" type="text" id="edit-card-rarity">
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="edit-card-type">Tipo Pokémon</label>
                            <input class="form-input" type="text" id="edit-card-type">
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="edit-card-nationality">Nacionalidade</label>
                            <input class="form-input" type="text" id="edit-card-nationality">
                        </div>
                    </div>

                    <div id="edit-other-fields" class="other-edit-fields" style="display: none;">
                        <h4 style="margin: 15px 0 10px; color: #333; font-size: 0.95em;">Detalhes do Produto</h4>

                        <div class="form-group">
                            <label class="form-label" for="edit-other-nationality">Nacionalidade</label>
                            <input class="form-input" type="text" id="edit-other-nationality">
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="edit-other-package">Conteúdo da Embalagem</label>
                            <textarea class="form-input" id="edit-other-package" rows="2"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="edit-other-info">Informações Extras</label>
                            <textarea class="form-input" id="edit-other-info" rows="2"></textarea>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary"
                            onclick="closeEditProductModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar Alterações</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmação de Exclusão -->
    <div id="delete-product-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>Confirmar Exclusão</h3>
                <button class="modal-close" onclick="closeDeleteProductModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>Tem certeza que deseja excluir o produto <strong id="delete-product-name"></strong>?</p>
                <p style="color: var(--danger-color); font-size: 0.9em; margin-top: 10px;">
                    <strong>Atenção:</strong> Esta ação não pode ser desfeita.
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeDeleteProductModal()">Cancelar</button>
                <button class="btn btn-danger" onclick="confirmDeleteProduct()">Excluir Produto</button>
            </div>
        </div>
    </div>

    <script src="../js/logout.js"></script>
    <script src="../js/inventory.js"></script>
    <script src="../js/movements.js"></script>
    <script src="../js/estoque.js"></script>
</body>

</html>